# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìã –ß—Ç–æ —Ç–∞–∫–æ–µ Supabase?

Supabase - —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π backend —Å PostgreSQL –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –ª—é–±–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞!

---

## üéØ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–ê–ì 1: –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ –ø—Ä–æ–µ–∫—Ç–∞

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://supabase.com**
2. –ù–∞–∂–º–∏—Ç–µ **"Start your project"** –∏–ª–∏ **"Sign up"**
3. –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ GitHub (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç
4. –ù–∞–∂–º–∏—Ç–µ **"New Project"**
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **Name**: `fitness-trainer-app` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ)
   - **Database Password**: –ø—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å (—Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ!)
   - **Region**: –≤—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `West US`)
   - **Pricing Plan**: –≤—ã–±–µ—Ä–∏—Ç–µ **Free** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
6. –ù–∞–∂–º–∏—Ç–µ **"Create new project"**
7. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã, –ø–æ–∫–∞ –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è

---

### –®–ê–ì 2: –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π

1. –í –ø–∞–Ω–µ–ª–∏ Supabase –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É **‚öôÔ∏è Settings** (–≤–Ω–∏–∑—É —Å–ª–µ–≤–∞)
2. –í—ã–±–µ—Ä–∏—Ç–µ **"API"** –≤ –º–µ–Ω—é
3. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"Project API keys"**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - **Project URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://xxxxx.supabase.co`)
   - **anon public** –∫–ª—é—á (–¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `eyJ...`)

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —ç—Ç–∏ –∫–ª—é—á–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ!

---

### –®–ê–ì 3: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

1. –í –ø–∞–Ω–µ–ª–∏ Supabase –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É **üìä Table Editor** (—Å–ª–µ–≤–∞)
2. –ù–∞–∂–º–∏—Ç–µ **"New table"**
3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É **`user_registration`**:

   **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:**
   - **Name**: `user_registration`
   - **Description**: `–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`
   - **Enable Row Level Security**: **–í–´–ö–õ–Æ–ß–ò–¢–ï** (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)

   **–î–æ–±–∞–≤—å—Ç–µ –∫–æ–ª–æ–Ω–∫–∏:**
   
   | Column name | Type | Default value | Is nullable |
   |-------------|------|---------------|-------------|
   | id | int8 | (auto) | ‚ùå |
   | telegram_id | text | - | ‚úÖ |
   | username | text | - | ‚ùå |
   | password | text | - | ‚ùå |
   | first_name | text | - | ‚ùå |
   | last_name | text | - | ‚ùå |
   | requested_role | text | - | ‚ùå |
   | status | text | 'pending' | ‚ùå |
   | approved_role | text | - | ‚úÖ |
   | registration_date | timestamptz | now() | ‚ùå |
   | created_at | timestamptz | now() | ‚ùå |
   | updated_at | timestamptz | now() | ‚ùå |

   **–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏:**
   - –ù–∞–∂–º–∏—Ç–µ **"Add column"**
   - –í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–æ–ª–æ–Ω–∫–∏
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø (text, timestamptz, int8)
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - –ù–∞–∂–º–∏—Ç–µ **"Save"**

4. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∫–æ–ª–æ–Ω–æ–∫ –Ω–∞–∂–º–∏—Ç–µ **"Save"** (–≤–Ω–∏–∑—É)

---

### –®–ê–ì 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ RLS (Row Level Security) - –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û

**–î–ª—è –¥–µ–º–æ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å**, –Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –í —Ç–∞–±–ª–∏—Ü–µ `user_registration` –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Policies"**
2. –ù–∞–∂–º–∏—Ç–µ **"New Policy"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"Enable read access for everyone"**
4. –ù–∞–∂–º–∏—Ç–µ **"Save"**
5. –°–æ–∑–¥–∞–π—Ç–µ –µ—â–µ –æ–¥–Ω—É –ø–æ–ª–∏—Ç–∏–∫—É: **"Enable insert access for everyone"**
6. –°–æ–∑–¥–∞–π—Ç–µ –µ—â–µ –æ–¥–Ω—É: **"Enable update access for everyone"**

**–ò–ª–∏ –ø—Ä–æ—â–µ**: –û—Ç–∫–ª—é—á–∏—Ç–µ RLS –¥–ª—è –¥–µ–º–æ (—É–∂–µ —Å–¥–µ–ª–∞–ª–∏ –≤—ã—à–µ)

---

### –®–ê–ì 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `utils/supabase-config.js`
2. –ó–∞–º–µ–Ω–∏—Ç–µ:
   ```javascript
   const SUPABASE_URL = 'YOUR_SUPABASE_URL';
   const SUPABASE_ANON_KEY = 'YOUR_SUPABASE_ANON_KEY';
   ```
   
   –ù–∞ –≤–∞—à–∏ –∑–Ω–∞—á–µ–Ω–∏—è:
   ```javascript
   const SUPABASE_URL = 'https://xxxxx.supabase.co'; // –í–∞—à Project URL
   const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'; // –í–∞—à anon key
   ```

3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª

---

### –®–ê–ì 6: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Supabase —Å–∫—Ä–∏–ø—Ç–∞ –≤ HTML

–û—Ç–∫—Ä–æ–π—Ç–µ –≤—Å–µ HTML —Ñ–∞–π–ª—ã –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–¥ `utils/trickle-api.js`:

```html
<!-- Supabase JS Client -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<!-- Supabase Config -->
<script src="utils/supabase-config.js"></script>
<!-- Trickle API —Å Supabase -->
<script src="utils/trickle-api-supabase.js"></script>
```

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- `register.html`
- `login.html`
- `admin.html`
- `client.html`
- `trainer.html`
- `index.html`

---

### –®–ê–ì 7: –ó–∞–º–µ–Ω–∞ trickle-api.js –Ω–∞ trickle-api-supabase.js

–í –∫–∞–∂–¥–æ–º HTML —Ñ–∞–π–ª–µ –∑–∞–º–µ–Ω–∏—Ç–µ:
```html
<script src="utils/trickle-api.js"></script>
```

–ù–∞:
```html
<script src="utils/trickle-api-supabase.js"></script>
```

---

### –®–ê–ì 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)
3. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: `‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö`
4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
5. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–º–æ–∂–Ω–æ –≤ –¥—Ä—É–≥–æ–º –±—Ä–∞—É–∑–µ—Ä–µ!)
6. **–ó–∞—è–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞!** ‚úÖ

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
console.log('Supabase –¥–æ—Å—Ç—É–ø–µ–Ω:', window.SUPABASE_CONFIG?.isAvailable());

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
trickleListObjects('user_registration', 10).then(r => console.log(r.items));
```

### –í –ø–∞–Ω–µ–ª–∏ Supabase:
1. –û—Ç–∫—Ä–æ–π—Ç–µ **Table Editor**
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `user_registration`
3. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤–∞—à–∏ –∑–∞—è–≤–∫–∏!

---

## ‚ùå –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç Supabase –∑–∞–≥—Ä—É–∂–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –∏ –∫–ª—é—á –≤ `supabase-config.js`

### –û—à–∏–±–∫–∞: "relation does not exist"
- –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `user_registration`)

### –û—à–∏–±–∫–∞: "new row violates row-level security"
- –í–∫–ª—é—á–∏—Ç–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ RLS –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã

### –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (RLS)

---

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã (SQL)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ SQL Editor:

```sql
CREATE TABLE user_registration (
  id BIGSERIAL PRIMARY KEY,
  telegram_id TEXT,
  username TEXT NOT NULL,
  password TEXT NOT NULL,
  first_name TEXT NOT NULL,
  last_name TEXT NOT NULL,
  requested_role TEXT NOT NULL,
  status TEXT NOT NULL DEFAULT 'pending',
  approved_role TEXT,
  registration_date TIMESTAMPTZ DEFAULT NOW(),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –û—Ç–∫–ª—é—á–∏—Ç—å RLS –¥–ª—è –¥–µ–º–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
ALTER TABLE user_registration DISABLE ROW LEVEL SECURITY;
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Supabase
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –ª—é–±–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞
- ‚úÖ –ù–µ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –∫—ç—à–∞
- ‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª–∏ Supabase

**–¢–µ–ø–µ—Ä—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∑ —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤!** üéâ

